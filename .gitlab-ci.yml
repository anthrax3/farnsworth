tests:
  services:
    - postgres:9.5
  script:
    - pip install -e .
    - ./setupdb.sh .env.test
    - nosetests tests
  tags: ["angr"]

# lint:
#   script: "lint.py"
#   tags: ["cgc-linter"]

docs:
  script: "generate_docs"
  tags: ["cgc-linter"]

build_images:
    only: ["master"]
    stage: deploy
    script:
    - cgc-build worker
    - cgc-build meister
    - cgc-build ambassador
    tags: ["docker-builder"]

update_vm_image:
    only: ["master"]
    stage: deploy
    script:
    - update-vm-image
    tags: ["docker-builder"]
