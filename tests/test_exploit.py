#!/usr/bin/env python2
# -*- coding: utf-8 -*-

from __future__ import absolute_import, unicode_literals

from nose.tools import *

from . import setup_each, teardown_each
from farnsworth.models import Exploit, ChallengeBinaryNode, AFLJob, ChallengeSet

class TestExploit:
    def setup(self): setup_each()
    def teardown(self): teardown_each()

    def test_pov_type(self):
        cs = ChallengeSet.create(name="foo")
        cbn = ChallengeBinaryNode.create(name="foo", cs=cs)
        job = AFLJob.create(cbn=cbn)
        exploit = Exploit.create(cbn=cbn, job=job, pov_type="type1", blob="exploit")

        assert_equals(exploit.pov_type, "type1")
        assert_raises(Exception, lambda: Exploit.create(cbn=cbn, job=job, pov_type="bar"))
