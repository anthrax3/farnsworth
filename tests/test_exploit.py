from nose.tools import *

import farnsworth.test_support
from farnsworth.models import Exploit, ChallengeBinaryNode, AFLJob

class TestExploit:
    def setup(self):
        farnsworth.test_support.truncate_tables()

    def test_pov_type(self):
        cbn = ChallengeBinaryNode.create(name = "foo", cs_id = "foo")
        job = AFLJob.create(cbn=cbn)
        exploit = Exploit.create(cbn=cbn, job=job, pov_type="type1")

        assert_equals(exploit.pov_type, "type1")
        assert_raises(Exception, lambda: Exploit.create(cbn=cbn, job=job, pov_type="bar"))
